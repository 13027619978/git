<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<meta http-equiv="Expires" content="0">
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="Cache-control" content="no-cache">
		<meta http-equiv="Cache" content="no-cache">
		<link rel="stylesheet" href="css/swiper.min.css">
		<link rel="stylesheet" href="css/reset.css">
		<style type="text/css">
			.container{
				background-color: #f5f5f5;
				min-height: 100vh;
			}
			.container .btnList{
				padding: 10px;
				display: flex;
				justify-content: space-between;
				align-items: flex-start;
				flex-wrap: wrap;
			}
			.container .btnList a{
				display: block;
				width: 49%;
				margin-bottom: 10px;
				background-color: #fff;
				border-radius: 5px;
				overflow: hidden;
				box-shadow: 0 0 5px #ddd;
			}
			.container .btnList img{
				width: 100%;
			}
			.container .btnList a>p{
				line-height: 35px;
				font-size: 14px;
				color: #333;
				padding: 0 10px;
				background: url(img/more-icon.png) no-repeat right center;
				background-size: 15px auto;
			}
			
			.cardView{
				width: 100%;
				background-color: #F0F0F0;
				padding-bottom: 25px;
			}
			.card{
				padding: 10px;
			}
			.cardInfo{
				position: relative;
				border-radius: 10px;
				overflow: hidden;
				box-shadow: 0 5px 5px #666;
			}
			.infoView{
				background: url(img/ykt.png) no-repeat left top;
				background-size: 100% 100%;
			}
			.infoContent{
				background: rgba(232, 41, 31, .2);
			}
			.infoView .cardTitle{
				font-size: 18px;
				color: #e7b14c;
				font-weight: bold;
				text-align: center;
				line-height: 45px;
			}
			.lastPrice{
				display: flex;
				justify-content: flex-start;
				align-items: center;
				background-color: #b88e52;
				padding: 5px 10px;
				border-radius: 5px;
			}
			.lastPrice span{
				display: block;
				height: 30px;
				color: #fff;
				border-left: 1px solid #fff;
				margin: 0 10px;
			}
			.totalMoney{
				font-size: 14px;
				color: #fff;
			}
			.totalMoney font{
				font-size: 30px;
				color: #e7b14c;
				font-weight: bold;
				margin-right: 5px;
			}
			.lastMoney{
				font-size: 12px;
				color: #fff;
				text-align: center;
			}
			.lastMoney font{
				color: #00ff00;
				font-size: 14px;
			}
			.numberView{
				padding: 5px 10px;
				background: #453c37;
			}
			.cardNumber{
				font-size: 12px;
				color: #fff;
			}
			.container .btnList a>p{
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding-right: 20px;
				font-weight: bold;
			}
			.imgView{
				height: 128px;
			}
			.priceView{
				padding: 5px;
			}
			.priceView p{
				font-size: 14px;
				color: #333;
				line-height: 22px;
				text-align: left;
			}
			.priceView .price{
				font-size: 14px;
				color: red;
				display: flex;
				justify-content: space-between;
				align-items: flex-end;
				margin-top: 5px;
			}
			.priceView .price font{
				display: block;
				font-size: 13px;
				width: 65px;
				line-height: 22px;
				border: 1px solid red;
				border-radius: 3px;
				text-align: center;
			}
			.priceView .price .sells{
				font-size: 12px;
				color: #666;
				line-height: 15px;
			}
			.bannerView{
				position: relative;
				width: 100%;
				overflow: hidden;
			}
			.swiper {
			    width: 100%;
			    height: 200px;
			}
			.swiper-slide{
				width: 100%;
				height: 200px;
				display: flex;
				justify-content: center;
				align-items: flex-end;
				overflow: hidden;
			}
			.swiper-slide img{
				width: 100%;
			}
			.swiper{
			    --swiper-pagination-color: #00ff33;
			  }
			.swiper-pagination-bullet-active{
				background: #00ff33 !important;
			}
		</style>
		<title>水上运动及休闲</title>
	</head>
	<body>
		<div class="container">
			<div class="bannerView">
				<div class="swiper">
					<div class="swiper-wrapper">
						<div class="swiper-slide">
							<img src="img/ssmxBanner.jpg" >
						</div>
						<div class="swiper-slide">
							<img src="img/ssmxBanner1.jpg" >
						</div>
						<div class="swiper-slide">
							<img src="img/ssmxBanner2.jpg" >
						</div>
						<div class="swiper-slide">
							<img src="img/ssmxBanner3.jpg" >
						</div>
						<div class="swiper-slide">
							<img src="img/ssmxBanner4.jpg" >
						</div>
					</div>
					<div class="swiper-pagination"></div>
				</div>
			</div>
			<div class="btnList">
				<a href="javascript:;" onclick="btnClick(1)">
					<div class="imgView">
						<img src="img/canoeBanner.png" >
					</div>
					<div class="priceView">
						<p>玄武湖皮划艇</p>
						<div class="price"><div>¥65-180<p class="sells">已售：0</p></div><font>点击购票</font></div>
					</div>
				</a>
				<a href="javascript:;" onclick="btnClick(4)">
					<div class="imgView">
						<img src="img/wx/wx4.jpg" >
					</div>
					<div class="priceView">
						<p>东南湖画舫游览</p>
						<div class="price"><div>¥30-198<p class="sells">已售：0</p></div><font>点击购票</font></div>
					</div>
				</a>
				<a href="javascript:;" onclick="btnClick(2)">
					<div class="imgView">
						<img src="img/lz1.png" >
					</div>
					<div class="priceView">
						<p>龙舟亲子优惠体验</p>
						<div class="price"><div>¥150<p class="sells">已售：0</p></div><font>点击购票</font></div>
					</div>
				</a>
				<a href="javascript:;" onclick="btnClick(3)">
					<div class="imgView">
						<img src="img/yy.jpg" >
					</div>
					<div class="priceView">
						<p>玄武湖豪华游船</p>
						<div class="price"><div>¥50<p class="sells">已售：0</p></div><font>点击购票</font></div>
					</div>
				</a>
				<a href="javascript:;" onclick="btnClick(5)">
					<div class="imgView">
						<img src="img/yyb1.jpg" >
					</div>
					<div class="priceView">
						<p>行走的湖上音乐吧</p>
						<div class="price"><div>¥198<p class="sells">已售：0</p></div><font>点击购票</font></div>
					</div>
				</a>
			</div>
		</div>
		<script src="js/jquery.min.js"></script>
		<script src="js/jweixin-1.0.0.js"></script>
		<script src="layer/layer.js"></script>
		<script src="js/swiper.min.js"></script> 	
		<script src="js/app.js"></script>
		<script type="text/javascript">
			$(function(){
				var mySwiper = new Swiper('.swiper', { 
					loop: true,
					autoplay:true,
					pagination: {
					    el: '.swiper-pagination',
					}
				});
				app.wxUserInfo(function(){
					var nowWeek = new Date().getDay();
					nowWeek = nowWeek==0?7:nowWeek;
					var nowHour = new Date().getHours();
					var nowMinutes = new Date().getMinutes();
					if(nowWeek == 6 && nowHour >= 16){
						$('.timeBtn').eq(0).attr('onclick', 'closeClick()').addClass('disabled');
					}
					if(nowWeek == 7 && nowHour >= 16){
						$('.timeBtn').attr('onclick', 'closeClick()').addClass('disabled');
					}
					var nowDateNum = new Date().getTime();
					var satDateNum = (6 - nowWeek) * 60 * 60 * 24 * 1000 + nowDateNum;
					var sunDateNum = (7 - nowWeek) * 60 * 60 * 24 * 1000 + nowDateNum;
					var satDate = new Date(satDateNum);
					var sunDate = new Date(sunDateNum);
					satTime = getDateString(satDate);
					sunTime = getDateString(sunDate);
					
					$.ajax({
					    url:'http://hd.smart-ideas.com.cn/xwhpark/canoeOrder/sales/collection',
					    type:"GET",
					    success:function(res){
							let totalNumber = 0;
							res.data.forEach(function(value, key){
								if(value.id == 6){
									totalNumber += parseInt(value.number);
								}else if(value.id == 1){
									totalNumber += parseInt(value.number);
								}else if(value.id == 2){
									totalNumber += parseInt(value.number);
								}else if(value.id == 4){
									totalNumber += parseInt(value.number);
								}else if(value.id == 5){
									totalNumber += parseInt(value.number);
								}else if(value.id == 7){
									totalNumber += parseInt(value.number);
								}
							})
							$('.price').eq(0).find('.sells').text('已售：' + totalNumber);
					    }
					});
					
					$.ajax({
					    url:'http://hd.smart-ideas.com.cn/xwhpark/deviceLoopApp/sales/collection',
					    type:"GET",
					    success:function(res){
							// 画舫票
							let hfTotal = 0;
					    	res.data.forEach(function(value, key){
					    		if(value.id == 18){
					    			$('.price').eq(2).find('.sells').text('已售：' + value.number);
					    		}else if(value.id == 17){
					    			$('.price').eq(3).find('.sells').text('已售：' + value.number);
					    		}else if(value.id == 19 || value.id == 20){
									hfTotal += parseInt(value.number);
					    		}else if(value.id == 21){
									$('.price').eq(4).find('.sells').text('已售：' + value.number);
					    		}
					    	})
							$('.price').eq(1).find('.sells').text('已售：' + hfTotal);
					    }
					});
				});
			})
			
			// 获取日期
			function getDateString(time){
				let dateString = new Date(time);
				let yearString = dateString.getFullYear();
				let monthString = dateString.getMonth() + 1;
				monthString = monthString > 9 ? monthString : '0' + monthString;
				let dayString = dateString.getDate();
				dayString = dayString > 9 ? dayString : '0' + dayString;
				return yearString + '-' + monthString + '-' + dayString;
			}
			
			function btnClick(btnType){
				if(btnType == 3){
					window.location.href = 'http://hd.smart-ideas.com.cn/xwhWeb/xwhAppTest/yyTickets.html?openid=' + app.getCookie('openid') + '&type=17'
				}else if(btnType == 2){
					window.location.href = 'http://hd.smart-ideas.com.cn/xwhWeb/xwhAppTest/lzxTickets.html?openid=' + app.getCookie('openid') + '&code=18'
				}else if(btnType == 1){
					window.location.href = 'http://hd.smart-ideas.com.cn/xwhWeb/xwhAppTest/canoeTickets.html?openid=' + app.getCookie('openid') + '&ticketType=1'
				}else if(btnType == 4){
					window.location.href = 'http://hd.smart-ideas.com.cn/xwhWeb/xwhAppTest/xyTicket.html?openid=' + app.getCookie('openid') + '&ticketType=7'
				}else if(btnType == 5){
					window.location.href = 'http://hd.smart-ideas.com.cn/xwhWeb/xwhAppTest/yybTicket.html?openid=' + app.getCookie('openid') + '&ticketType=21'
				}
			}
		</script>
	</body>
</html>
